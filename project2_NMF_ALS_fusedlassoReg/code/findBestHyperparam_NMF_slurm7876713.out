# Confirm Python version and conda environment
echo "Using Python: $(which python)"
Using Python: /ix/ccdg/storage3/til177/custom_miniconda/envs/hugen_general/bin/python
python -V
Python 3.11.9
echo "Conda env: $CONDA_DEFAULT_ENV"
Conda env: hugen_general

start_time=$(date +%s)

# Grid search
python nmf_als_fusedlasso.py -b ../data/chr10 -c chr10 -s 1000000 -e 1500000  -k 15

 0 ../data/chr10/SRF.K562.rawSignal.hg18.chr10.bw

 1 ../data/chr10/GATA1.K562.rawSignal.hg18.chr10.bw

 2 ../data/chr10/Max.K562.rawSignal.hg18.chr10.bw

 3 ../data/chr10/CTCF.K562.Iyer.rawSignal.hg18.chr10.bw

 4 ../data/chr10/cFos.K562.rawSignal.hg18.chr10.bw

 5 ../data/chr10/H3K4me1.K562.rawSignal.hg18.chr10.bw

 6 ../data/chr10/H3K4me2.K562.rawSignal.hg18.chr10.bw

 7 ../data/chr10/JunD.K562.rawSignal.hg18.chr10.bw

 8 ../data/chr10/NFE2.K562.rawSignal.hg18.chr10.bw

 9 ../data/chr10/FAIRE.K562.rawSignal.hg18.chr10.bw

 10 ../data/chr10/Pol2_8WG16.K562.Snyder.rawSignal.hg18.chr10.bw

 11 ../data/chr10/Rad21.K562.rawSignal.hg18.chr10.bw

 12 ../data/chr10/XRCC4.K562.rawSignal.hg18.chr10.bw

 13 ../data/chr10/H3K36me3.K562.rawSignal.hg18.chr10.bw

 14 ../data/chr10/cMyc.K562.Iyer.rawSignal.hg18.chr10.bw

 15 ../data/chr10/Pol2_CTD4H8.K562.rawSignal.hg18.chr10.bw

 16 ../data/chr10/H3K9me1.K562.rawSignal.hg18.chr10.bw

 17 ../data/chr10/CTCF.K562.Bernstein.rawSignal.hg18.chr10.bw

 18 ../data/chr10/ZNF263.K562.rawSignal.hg18.chr10.bw

 19 ../data/chr10/DNaseI.K562.Crawford.rawSignal.hg18.chr10.bw

 20 ../data/chr10/Pol2_8WG16.K562.Myers.rawSignal.hg18.chr10.bw

 21 ../data/chr10/cMyc.K562.Snyder.rawSignal.hg18.chr10.bw

 22 ../data/chr10/H3K9ac.K562.rawSignal.hg18.chr10.bw

 23 ../data/chr10/H3K27me3.K562.rawSignal.hg18.chr10.bw

 24 ../data/chr10/DNaseI.K562.Stam.rawSignal.hg18.chr10.bw

 25 ../data/chr10/H3K27ac.K562.rawSignal.hg18.chr10.bw

 26 ../data/chr10/cJun.K562.rawSignal.hg18.chr10.bw

 27 ../data/chr10/H4K20me1.K562.rawSignal.hg18.chr10.bw

 28 ../data/chr10/GABP.K562.rawSignal.hg18.chr10.bw

 29 ../data/chr10/NRSF.K562.rawSignal.hg18.chr10.bw
(500000, 30)

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====
Converged at iteration 153
l2=1e-06 fl=0 score=0.0960 best_j=10

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=1e-06 fl=0.1 score=0.3846 best_j=5

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=1e-06 fl=0.3 score=0.5696 best_j=3

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=1e-06 fl=1 score=0.4099 best_j=9

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=1e-06 fl=3 score=0.4092 best_j=6

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=1e-06 fl=10 score=0.3880 best_j=7

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====
Converged at iteration 374
l2=0.0001 fl=0 score=0.0989 best_j=10

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=0.0001 fl=0.1 score=0.3366 best_j=12

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=0.0001 fl=0.3 score=0.3924 best_j=12

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=0.0001 fl=1 score=0.2763 best_j=11

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=0.0001 fl=3 score=0.3233 best_j=12

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=0.0001 fl=10 score=0.1803 best_j=12

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====
Converged at iteration 224
l2=0.01 fl=0 score=0.0989 best_j=10

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====
Converged at iteration 284
l2=0.01 fl=0.1 score=0.1589 best_j=12

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====
Converged at iteration 68
l2=0.01 fl=0.3 score=0.1799 best_j=7

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=0.01 fl=1 score=0.2074 best_j=10

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=0.01 fl=3 score=0.3895 best_j=8

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=0.01 fl=10 score=0.4153 best_j=10

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====
Converged at iteration 366
l2=0.1 fl=0 score=0.0987 best_j=10

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=0.1 fl=0.1 score=0.1120 best_j=12

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====
Converged at iteration 165
l2=0.1 fl=0.3 score=0.1609 best_j=7

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====
Converged at iteration 228
l2=0.1 fl=1 score=0.1768 best_j=7

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=0.1 fl=3 score=0.1993 best_j=10

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=0.1 fl=10 score=0.3351 best_j=14

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====
Converged at iteration 255
l2=1 fl=0 score=0.0987 best_j=10

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=1 fl=0.1 score=0.1032 best_j=10

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=1 fl=0.3 score=0.1103 best_j=12

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====
Converged at iteration 222
l2=1 fl=1 score=0.1650 best_j=14

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====
Converged at iteration 124
l2=1 fl=3 score=0.2574 best_j=14

 Completed randomized_svd H initialization...

 ==== Starting iteration 0 ====

 ==== Starting iteration 50 ====

 ==== Starting iteration 100 ====

 ==== Starting iteration 150 ====

 ==== Starting iteration 200 ====

 ==== Starting iteration 250 ====

 ==== Starting iteration 300 ====

 ==== Starting iteration 350 ====

 ==== Starting iteration 400 ====

 ==== Starting iteration 450 ====

 ==== Starting iteration 500 ====

 ==== Starting iteration 550 ====

 ==== Starting iteration 600 ====

 ==== Starting iteration 650 ====

 ==== Starting iteration 700 ====

 ==== Starting iteration 750 ====

 ==== Starting iteration 800 ====

 ==== Starting iteration 850 ====

 ==== Starting iteration 900 ====

 ==== Starting iteration 950 ====
l2=1 fl=10 score=0.3738 best_j=13
BEST: (0.5696075371921364, 1e-06, 0.3)
python nmf_als_fusedlasso.py -b ../data/chr10 -c chr10 -s 1000000 -e 11000000 -k 10
slurmstepd: error: *** JOB 7876713 ON htc-n38 CANCELLED AT 2026-02-03T21:52:59 ***
